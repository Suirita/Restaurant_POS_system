<div class="relative inline-block w-60" [ngClass]="className" #dateRangePicker>
  <!-- Trigger Button -->
  <button
    type="button"
    (click)="toggleOpen()"
    class="text-gray-900 bg-white w-full flex items-center justify-start rounded-lg border border-gray-200 shadow-xs px-3 py-2 text-left text-sm"
  >
    <i-lucide [img]="CalendarRange" class="mr-2 h-5 w-5"></i-lucide>
    {{ formatDateRange() }}
  </button>

  <!-- Popover -->
  <div
    *ngIf="isOpen"
    class="absolute z-50 mt-2 w-64 bg-white rounded-lg border border-gray-200 shadow-xs p-3"
  >
    <!-- Header -->
    <div class="flex items-center justify-between mb-4">
      <button
        class="h-8 w-8 flex items-center justify-center bg-black text-white rounded-lg border shadow-2xs"
        (click)="navigateMonth('prev')"
      >
        <i-lucide [img]="ChevronLeft" class="h-5 w-5"></i-lucide>
      </button>
      <div class="text-sm font-medium">
        {{ MONTHS[currentMonth] }} {{ currentYear }}
      </div>
      <button
        class="h-8 w-8 flex items-center justify-center bg-black text-white rounded-lg border shadow-2xs"
        (click)="navigateMonth('next')"
      >
        <i-lucide [img]="ChevronRight" class="h-5 w-5"></i-lucide>
      </button>
    </div>

    <!-- Weekdays -->
    <div class="grid grid-cols-7 gap-1 mb-2">
      <div
        *ngFor="let day of DAYS"
        class="h-9 w-9 flex items-center justify-center text-sm font-medium text-gray-500"
      >
        {{ day }}
      </div>
    </div>

    <!-- Days -->
    <div class="grid grid-cols-7 gap-1">
      <ng-container *ngFor="let day of renderCalendar(); let i = index">
        <div *ngIf="day === null" class="h-9 w-9"></div>
        <button
          *ngIf="day !== null"
          (click)="handleDateClick(createNewDate(day))"
          (mouseenter)="hoverDate = createNewDate(day)"
          (mouseleave)="hoverDate = null"
          class="h-9 w-9 text-sm rounded flex items-center justify-center hover:bg-gray-800 hover:text-white hover:z-10 transition-colors"
          [ngClass]="{
            'bg-black text-white z-10': isRangeStart(createNewDate(day)) || isRangeEnd(createNewDate(day)),
            'bg-gray-100': (isInRange(createNewDate(day), value.from, value.to) || isHovering(createNewDate(day))) && !isRangeStart(createNewDate(day)) && !isRangeEnd(createNewDate(day)),
            'font-medium': isSameDay(today, createNewDate(day))
          }"
        >
          {{ day }}
        </button>
      </ng-container>
    </div>
  </div>
</div>
